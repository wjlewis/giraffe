(this.webpackJsonpgiraffe=this.webpackJsonpgiraffe||[]).push([[0],{21:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var r,c=n(2),a=n.n(c),o=n(15),i=n.n(o),u=(n(21),n(0)),s=n(5),d=n(6),h=n(16),l=n(7),f=n(3),p=n(4),b=function(){function e(t,n){Object(f.a)(this,e),this.x=t,this.y=n}return Object(p.a)(e,[{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"scale",value:function(t){return new e(t*this.x,t*this.y)}},{key:"plus",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"minus",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"proj",value:function(e){var t=e.dot(e);if(0===t)throw new Error("attempt to project onto the zero vector");var n=this.dot(e);return e.scale(n/t)}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"perp",value:function(){var t=new e(1,0).dot(this),n=new e(0,1).dot(this);return new e(-n,t)}},{key:"crossSign",value:function(e){var t=this.x*e.y-this.y*e.x;return Math.sign(t)}},{key:"normalize",value:function(){var e=this.length();if(0===e)throw new Error("attempt to normalize zero vector");return this.scale(1/e)}},{key:"rotate",value:function(t){var n=Math.cos(t),r=Math.sin(t);return new e(this.x*n+this.y*r,-this.x*r+this.y*n)}}]),e}(),j=function(){function e(){Object(f.a)(this,e),this.type=void 0,this.value=void 0}return Object(p.a)(e,[{key:"map",value:function(t){switch(this.type){case r.Some:return e.Some(t(this.value));case r.None:return this}}},{key:"match",value:function(e){switch(this.type){case r.Some:return e.some(this.value);case r.None:return e.none()}}},{key:"unwrap",value:function(){if(this.type===r.None)throw new Error("attempt to unwrap `None` variant of `Option`");return this.value}}],[{key:"Some",value:function(t){var n=new e;return n.type=r.Some,n.value=t,n}},{key:"None",value:function(){var t=new e;return t.type=r.None,t}},{key:"from",value:function(t){return t?e.Some(t):e.None()}}]),e}();!function(e){e.Some="Option.Some",e.None="Option.None"}(r||(r={}));var O,v=function(){function e(){Object(f.a)(this,e),this.type=void 0,this.ok=void 0,this.err=void 0}return Object(p.a)(e,[{key:"match",value:function(e){switch(this.type){case O.Ok:return e.ok(this.ok);case O.Err:return e.err(this.err)}}}],[{key:"Ok",value:function(t){var n=new e;return n.type=O.Ok,n.ok=t,n}},{key:"Err",value:function(t){var n=new e;return n.type=O.Err,n.err=t,n}}]),e}();!function(e){e.Ok="Ok",e.Err="Err"}(O||(O={}));var g=function(){function e(t,n){Object(f.a)(this,e),this.minCorner=void 0,this.maxCorner=void 0;var r=Math.min(t.x,n.x),c=Math.min(t.y,n.y),a=Math.max(t.x,n.x),o=Math.max(t.y,n.y);this.minCorner=new b(r,c),this.maxCorner=new b(a,o)}return Object(p.a)(e,[{key:"x",get:function(){return this.minCorner.x}},{key:"y",get:function(){return this.minCorner.y}},{key:"width",get:function(){return this.maxCorner.x-this.minCorner.x}},{key:"height",get:function(){return this.maxCorner.y-this.minCorner.y}},{key:"contains",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.minus(this.minCorner),r=this.maxCorner.minus(e);return n.x>t&&n.y>t&&r.x>t&&r.y>t}}]),e}();function y(){}function m(e){return e.reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(l.a)({},t.id,t))}),{})}function x(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return e&&"object"===typeof e?Object.keys(e).filter((function(t){return e[t]})).map((function(e){return String(e)})).join(" "):String(e)})).join(" ")}var w,k=function(){function e(){Object(f.a)(this,e),this.type=void 0,this.vertexIds=void 0}return Object(p.a)(e,[{key:"match",value:function(e){switch(this.type){case w.None:return e.none();case w.Vertices:return e.vertices(this.vertexIds)}}}],[{key:"None",value:function(){var t=new e;return t.type=w.None,t}},{key:"Vertices",value:function(t){var n=new e;return n.type=w.Vertices,n.vertexIds=t,n}}]),e}();!function(e){e.None="None",e.Vertices="Vertices"}(w||(w={}));var N,V=function(){function e(){Object(f.a)(this,e),this.type=void 0,this.boxSelectionRootPos=void 0,this.vertexOffsets=void 0,this.edgeOffsets=void 0,this.edgeId=void 0}return Object(p.a)(e,[{key:"isNone",value:function(){return this.type===N.None}},{key:"isBoxSelection",value:function(){return this.type===N.BoxSelection}},{key:"isNewVertex",value:function(){return this.type===N.NewVertex}},{key:"match",value:function(e){switch(this.type){case N.None:return e.none();case N.BoxSelection:return e.boxSelection(this.boxSelectionRootPos);case N.Vertices:return e.vertices(this.vertexOffsets,this.edgeOffsets);case N.EdgeControlPt:return e.edgeControlPt(this.edgeId);case N.NewVertex:return e.newVertex()}}}],[{key:"None",value:function(){var t=new e;return t.type=N.None,t}},{key:"BoxSelection",value:function(t){var n=new e;return n.type=N.BoxSelection,n.boxSelectionRootPos=t,n}},{key:"Vertices",value:function(t,n){var r=new e;return r.type=N.Vertices,r.vertexOffsets=t,r.edgeOffsets=n,r}},{key:"EdgeControlPt",value:function(t){var n=new e;return n.type=N.EdgeControlPt,n.edgeId=t,n}},{key:"NewVertex",value:function(){var t=new e;return t.type=N.NewVertex,t}}]),e}();!function(e){e.None="None",e.BoxSelection="BoxSelection",e.Vertices="Vertices",e.EdgeControlPt="EdgeControlPt",e.NewVertex="NewVertex"}(N||(N={}));var S=n(14),M=function(){function e(t){Object(f.a)(this,e),this.emptyState=t,this.undoStack=void 0,this.redoStack=void 0,this.undoStack=[t],this.redoStack=[]}return Object(p.a)(e,[{key:"commit",value:function(t){var n=new e(this.emptyState);return n.undoStack=[t].concat(Object(d.a)(this.undoStack.slice(0,e.MAX_UNDOS-1))),n.redoStack=[],n}},{key:"undo",value:function(){if(this.undoStack.length<2)return j.None();var t=new e(this.emptyState),n=Object(S.a)(this.undoStack),r=n[0],c=n[1],a=n.slice(2);return t.undoStack=[c].concat(Object(d.a)(a)),t.redoStack=[r].concat(Object(d.a)(this.redoStack)),j.Some([c,t])}},{key:"redo",value:function(){if(this.redoStack.length<1)return j.None();var t=new e(this.emptyState),n=Object(S.a)(this.redoStack),r=n[0],c=n.slice(1);return t.redoStack=c,t.undoStack=[r].concat(Object(d.a)(this.undoStack)),j.Some([r,t])}}]),e}();M.MAX_UNDOS=16;var E,C=function(){function e(){Object(f.a)(this,e),this.type=void 0,this.graph=void 0,this.errors=void 0}return Object(p.a)(e,[{key:"isNone",value:function(){return this.type===E.None}},{key:"match",value:function(e){switch(this.type){case E.None:return e.none();case E.Graph:return e.graph(this.graph);case E.Errors:return e.errors(this.errors)}}}],[{key:"None",value:function(){var t=new e;return t.type=E.None,t}},{key:"Graph",value:function(t){var n=new e;return n.type=E.Graph,n.graph=t,n}},{key:"Errors",value:function(t){var n=new e;return n.type=E.Errors,n.errors=t,n}}]),e}();!function(e){e.None="None",e.Graph="Graph",e.Errors="Errors"}(E||(E={}));var I,P=a.a.createContext({state:null,dispatch:null});!function(e){e.None="None",e.Forward="Forward",e.Reverse="Reverse"}(I||(I={}));var D,R={vertices:{byId:{1:{id:1,name:"a",pos:new b(-298.33331298828125,-125.08334350585938)},2:{id:2,name:"b",pos:new b(51.66668701171875,-211.08334350585938)},3:{id:3,name:"c",pos:new b(209.66668701171875,66.91665649414062)},4:{id:4,name:"d",pos:new b(-147.33331298828125,160.91665649414062)}},wip:j.None(),hovered:j.None()},edges:{byId:{1:{id:1,startVertexId:1,endVertexId:4,controlPtPos:new b(-299.33331298828125,43.91665649414061),direction:I.Reverse},2:{id:2,startVertexId:1,endVertexId:2,controlPtPos:new b(-159.5464273137012,-233.6503719672334),direction:I.Forward},3:{id:3,startVertexId:2,endVertexId:3,controlPtPos:new b(204.41999697432448,-86.65044718436185),direction:I.Forward},4:{id:4,startVertexId:3,endVertexId:4,controlPtPos:new b(63.526792958632,177.73087032210645),direction:I.Forward},5:{id:5,startVertexId:2,endVertexId:4,controlPtPos:new b(-47.83331298828125,-25.083343505859375),direction:I.None}},wip:j.None(),hovered:j.None()}},A={ui:{mousePos:new b(0,0),selection:k.None(),dragSubject:V.None(),isMultiSelect:!1,hasMoved:!1},graph:R,overlay:C.None(),undoRedo:new M(R)};function K(){return{type:D.AddVertex}}function L(e){return{type:D.RemoveVertices,payload:e}}function U(e,t){return{type:D.AddEdge,payload:{startVertexId:e,endVertexId:t}}}function G(e){return{type:D.RemoveEdge,payload:e}}function B(){return{type:D.CommitCurrentGraphState}}!function(e){e.MouseDownCanvas="MouseDownCanvas",e.MouseDownVertex="MouseDownVertex",e.MouseDownEdgeControlPt="MouseDownEdgeControlPt",e.MouseDownNewVertex="MouseDownNewVertex",e.MouseMove="MouseMove",e.MouseUp="MouseUp",e.KeyDown="KeyDown",e.KeyUp="KeyUp",e.AddVertex="AddVertex",e.RemoveVertices="RemoveVertices",e.AddEdge="AddEdge",e.RemoveEdge="RemoveEdge",e.ShiftKeyDown="ShiftKeyDown",e.CancelCurrentAction="CancelCurrentAction",e.SelectAllVertices="SelectAllVertices",e.ChangeVertexName="ChangeVertexName",e.MouseEnterVertex="MouseEnterVertex",e.MouseLeaveVertex="MouseLeaveVertex",e.MouseEnterEdgeControlPt="MouseEnterEdgeControlPt",e.MouseLeaveEdgeControlPt="MouseLeaveEdgeControlPt",e.ToggleEdgeDirection="ToggleEdgeDirection",e.CommitCurrentGraphState="CommitCurrentGraphState",e.Undo="Undo",e.Redo="Redo",e.OpenGraphOverlay="OpenGraphOverlay",e.OpenErrorsOverlay="OpenErrorsOverlay",e.DismissOverlay="DismissOverlay"}(D||(D={}));var T=n(1),z=15,F=function(e){var t=a.a.useContext(P),n=t.state,r=t.dispatch,c=e.id,o=e.name,i=e.pos,u=function(e,t){return e.ui.selection.match({none:function(){return!1},vertices:function(e){return e.includes(t)}})}(n,c),s=function(e,t){return e.ui.dragSubject.match({boxSelection:function(n){var r=new g(n,X(e)),c=e.graph.vertices.byId[t];return r.contains(c.pos,z)},none:function(){return!1},vertices:function(){return!1},edgeControlPt:function(){return!1},newVertex:function(){return!1}})}(n,c),d=function(e,t){return e.graph.vertices.hovered.match({none:function(){return!1},some:function(e){return e===t}})}(n,c),h=function(e,t){var n=e.graph.vertices.byId[t].name;return Boolean(_(e).find((function(e){var r=e.id,c=e.name;return r!==t&&c===n})))}(n,c),l=0===o.length;var f=(d?1.5:1)*z;return Object(T.jsxs)("g",{children:[Object(T.jsx)("foreignObject",{x:i.x-z,y:i.y+f,width:"2em",height:"2em",children:Object(T.jsx)("input",{className:x("vertex-name-input",{duplicate:h,missing:l}),type:"text",maxLength:2,value:o,placeholder:"!",onChange:function(e){return r(function(e,t){return{type:D.ChangeVertexName,payload:{vertexId:e,name:t}}}(c,e.target.value))}})}),Object(T.jsxs)("g",{className:x("vertex",{hovered:s,selected:u}),onMouseEnter:function(){return r((e=c,{type:D.MouseEnterVertex,payload:e}));var e},onMouseLeave:function(){return r({type:D.MouseLeaveVertex})},onMouseDown:function(){return r((e=c,{type:D.MouseDownVertex,payload:e}));var e},children:[Object(T.jsx)("circle",{cx:i.x,cy:i.y,r:22.5,fill:"transparent"}),Object(T.jsx)("circle",{className:"vertex-dot",cx:i.x,cy:i.y,r:f,strokeWidth:"2"})]})]})};function q(e,t){return e.graph.vertices.wip.match({none:function(){return e.graph.vertices.byId[t].pos},some:function(e){return e[t].pos}})}function W(e){return e.ui.selection.match({none:function(){return[]},vertices:function(e){return e}})}function X(e){return e.ui.mousePos}function _(e){return Object.values(e.graph.vertices.wip.match({none:function(){return e.graph.vertices.byId},some:function(e){return e}}))}function J(e){return Object.values(e.graph.edges.wip.match({none:function(){return e.graph.edges.byId},some:function(e){return e}}))}function Q(e){return e.ui.isMultiSelect}function Y(e){var t=_(e).map((function(e){return e.id}));return Math.max.apply(Math,[0].concat(Object(d.a)(t)))+1}function Z(e){return e.ui.selection}function H(e,t,n){var r=[t,n],c=J(e);return j.from(c.find((function(e){return r.includes(e.startVertexId)&&r.includes(e.endVertexId)})))}var $="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");function ee(e){var t=_(e).map((function(e){return e.name})),n=$.filter((function(e){return!t.includes(e)}));if(n.length>0)return n[0];for(var r=function(e){var n=$.map((function(t){return"".concat(t).concat(e)})).filter((function(e){return!t.includes(e)}));if(n.length>0)return{v:n[0]}},c=0;c<=9;c++){var a=r(c);if("object"===typeof a)return a.v}return""}function te(e){return e.ui.hasMoved}function ne(e,t){return e.graph.vertices.wip.match({none:function(){return e.graph.vertices.byId[t]},some:function(e){return e[t]}})}function re(e){var t=function(e){return function(e){var t,n=[],r=[],c=Object(h.a)(e);try{for(c.s();!(t=c.n()).done;){var a=t.value;n.includes(a)&&!r.includes(a)&&r.push(a),n.push(a)}}catch(o){c.e(o)}finally{c.f()}return r}(_(e).map((function(e){return e.name}))).filter((function(e){return e.length>0}))}(e),n=function(e){return _(e).map((function(e){return e.name})).filter((function(e){return 0===e.length})).length}(e),r=[];if(t.length>0)if(1===t.length)r.push('The name "'.concat(t[0],'" is used more than once'));else{var c=t.map((function(e){return'"'.concat(e,'"')})).join(", ");r.push("The names ".concat(c," are used more than once"))}if(n>0&&(1===n?r.push("1 vertex is missing a name"):r.push("".concat(n," vertices are missing names"))),r.length>0)return v.Err(r);var a=J(e).map((function(t){var n=ne(e,t.startVertexId),r=ne(e,t.endVertexId);switch(t.direction){case I.None:return"".concat(n.name," <-> ").concat(r.name);case I.Forward:return"".concat(n.name," -> ").concat(r.name);case I.Reverse:return"".concat(r.name," -> ").concat(n.name)}return""}));return v.Ok("Graph[{ ".concat(a.join(", "),' }, VertexLabels -> "Name"]'))}function ce(){return function(e,t){return function(n){if(n.type!==D.KeyDown)return t(n);switch(n.payload.key){case"Shift":return t({type:D.ShiftKeyDown});case"a":return n.payload.ctrlKey||n.payload.metaKey?t({type:D.SelectAllVertices}):t(K());case"Delete":case"Backspace":case"d":return Z(e).match({none:function(){return t(n)},vertices:function(e){return t(L(e))}});case"e":return Z(e).match({none:function(){return t(n)},vertices:function(r){if(2===r.length){var c=Object(s.a)(r,2),a=c[0],o=c[1];return H(e,a,o).match({none:function(){return t(U(a,o))},some:function(e){return t(G(e.id))}})}return t(n)}});case"Escape":return t({type:D.CancelCurrentAction});case"z":return n.payload.ctrlKey||n.payload.metaKey?t({type:D.Undo}):t(n);case"y":case"Z":return n.payload.ctrlKey||n.payload.metaKey?t({type:D.Redo}):t(n);default:return t(n)}}}}function ae(e,t){switch(t.type){case D.MouseDownCanvas:return function(e){var t=V.BoxSelection(X(e)),n=Q(e)?e.ui.selection:k.None();return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{dragSubject:t,selection:n})})}(e);case D.MouseDownVertex:return function(e,t){var n=t.payload,r=W(e),c=Q(e)?(i=r,s=n,i.includes(s)?i.filter((function(e){return e!==s})):[].concat(Object(d.a)(i),[s])):r.includes(n)?r:[n],a=function(e,t){var n=X(e);return m(t.map((function(t){return e.graph.vertices.byId[t]})).map((function(e){return{id:e.id,mouseOffset:e.pos.minus(n)}})))}(e,c),o=function(e,t){return m(J(e).filter((function(e){return t.includes(e.startVertexId)||t.includes(e.endVertexId)})).map((function(t){return function(e,t){var n=q(e,t.startVertexId),r=q(e,t.endVertexId).minus(n),c=t.controlPtPos.minus(n),a=c.proj(r),o=c.minus(a),i=a.crossSign(o),u=Math.sign(a.dot(r))*a.length()/r.length();return{id:t.id,pqRatio:u,perpLen:i*o.length()}}(e,t)})))}(e,c);var i,s;return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{selection:k.Vertices(c),dragSubject:V.Vertices(a,o),hasMoved:!1}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{wip:j.Some(e.graph.vertices.byId)}),edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{wip:j.Some(e.graph.edges.byId)})})})}(e,t);case D.MouseDownEdgeControlPt:return function(e,t){return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{dragSubject:V.EdgeControlPt(t.payload),hasMoved:!1}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{wip:j.Some(e.graph.edges.byId)})})})}(e,t);case D.MouseDownNewVertex:return function(e){var t={id:Y(e),name:ee(e),pos:X(e)};return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{dragSubject:V.None()}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{byId:Object(u.a)(Object(u.a)({},e.graph.vertices.byId),{},Object(l.a)({},t.id,t))})})})}(e);case D.MouseUp:return function(e){return e.ui.dragSubject.match({none:function(){return e},vertices:function(){return function(e){return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{dragSubject:V.None()}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{byId:e.graph.vertices.wip.unwrap(),wip:j.None()}),edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{byId:e.graph.edges.wip.unwrap(),wip:j.None()})})})}(e)},boxSelection:function(t){return function(e,t){var n=new g(t,X(e)),r=function(e,t){return _(e).filter((function(e){return t.contains(e.pos,z)})).map((function(e){return e.id}))}(e,n),c=Q(e)?[].concat(Object(d.a)(W(e)),Object(d.a)(r)):r,a=0===c.length?k.None():k.Vertices(c);return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{dragSubject:V.None(),selection:a})})}(e,t)},edgeControlPt:function(){return function(e){return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{dragSubject:V.None()}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{byId:e.graph.edges.wip.unwrap(),wip:j.None()})})})}(e)},newVertex:function(){return e}})}(e);case D.MouseMove:return function(e,t){var n=t.payload,r=Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{mousePos:n})});return e.ui.dragSubject.match({vertices:function(e,t){return function(e,t,n){var r=X(e),c=Object.values(t).map((function(t){var n=t.id,c=t.mouseOffset,a=e.graph.vertices.byId[n],o=r.plus(c);return Object(u.a)(Object(u.a)({},a),{},{pos:o})})),a=e.graph.vertices.wip.map((function(e){return Object(u.a)(Object(u.a)({},e),m(c))})),o=Object.values(n).map((function(t){var n=t.id,r=t.pqRatio,c=t.perpLen,o=e.graph.edges.byId[n],i=a.unwrap()[o.startVertexId].pos,s=a.unwrap()[o.endVertexId].pos.minus(i).scale(r),d=s.perp().normalize().scale(c),h=i.plus(s).plus(d);return Object(u.a)(Object(u.a)({},o),{},{controlPtPos:h})})),i=e.graph.edges.wip.map((function(e){return Object(u.a)(Object(u.a)({},e),m(o))}));return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{hasMoved:!0}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{wip:a}),edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{wip:i})})})}(r,e,t)},edgeControlPt:function(e){return function(e,t){return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{hasMoved:!0}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{wip:e.graph.edges.wip.map((function(n){return Object(u.a)(Object(u.a)({},n),{},Object(l.a)({},t,Object(u.a)(Object(u.a)({},e.graph.edges.byId[t]),{},{controlPtPos:e.ui.mousePos})))}))})})})}(r,e)},boxSelection:function(){return r},newVertex:function(){return r},none:function(){return r}})}(e,t);case D.AddVertex:return function(e){return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{dragSubject:V.NewVertex()})})}(e);case D.RemoveVertices:return function(e,t){var n=_(e),r=t.payload,c=n.filter((function(e){return!r.includes(e.id)})),a=J(e).filter((function(e){return!r.includes(e.startVertexId)&&!r.includes(e.endVertexId)}));return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{selection:k.None()}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{byId:m(c)}),edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{byId:m(a)})})})}(e,t);case D.AddEdge:return function(e,t){var n=t.payload,r=n.startVertexId,c=n.endVertexId,a=function(e){var t=J(e).map((function(e){return e.id}));return Math.max.apply(Math,[0].concat(Object(d.a)(t)))+1}(e),o=q(e,r),i=q(e,c).minus(o).scale(.5).plus(o),s={id:a,startVertexId:r,endVertexId:c,controlPtPos:i,direction:I.None},h=Object(u.a)(Object(u.a)({},e.graph.edges.byId),{},Object(l.a)({},a,s));return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{selection:k.None()}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{byId:h})})})}(e,t);case D.RemoveEdge:return function(e,t){var n=t.payload,r=J(e).filter((function(e){return e.id!==n}));return Object(u.a)(Object(u.a)({},e),{},{graph:Object(u.a)(Object(u.a)({},e.graph),{},{edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{byId:m(r)})})})}(e,t);case D.ShiftKeyDown:return function(e){return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{isMultiSelect:!0})})}(e);case D.KeyUp:return function(e){return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{isMultiSelect:!1})})}(e);case D.CancelCurrentAction:return function(e){return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{dragSubject:V.None()}),graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{wip:j.None()}),edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{wip:j.None()})})})}(e);case D.SelectAllVertices:return function(e){var t=_(e).map((function(e){return e.id}));return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{selection:k.Vertices(t)})})}(e);case D.ChangeVertexName:return function(e,t){var n=t.payload,r=n.vertexId,c=n.name,a=e.graph.vertices.byId,o=a[r],i=Object(u.a)(Object(u.a)({},a),{},Object(l.a)({},r,Object(u.a)(Object(u.a)({},o),{},{name:c})));return Object(u.a)(Object(u.a)({},e),{},{graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{byId:i})})})}(e,t);case D.MouseEnterVertex:return function(e,t){return Object(u.a)(Object(u.a)({},e),{},{graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{hovered:j.Some(t.payload)})})})}(e,t);case D.MouseLeaveVertex:return function(e){return Object(u.a)(Object(u.a)({},e),{},{graph:Object(u.a)(Object(u.a)({},e.graph),{},{vertices:Object(u.a)(Object(u.a)({},e.graph.vertices),{},{hovered:j.None()})})})}(e);case D.MouseEnterEdgeControlPt:return function(e,t){return Object(u.a)(Object(u.a)({},e),{},{graph:Object(u.a)(Object(u.a)({},e.graph),{},{edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{hovered:j.Some(t.payload)})})})}(e,t);case D.MouseLeaveEdgeControlPt:return function(e){return Object(u.a)(Object(u.a)({},e),{},{graph:Object(u.a)(Object(u.a)({},e.graph),{},{edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{hovered:j.None()})})})}(e);case D.ToggleEdgeDirection:return function(e,t){var n=function(e,t){return e.graph.edges.wip.match({none:function(){return e.graph.edges.byId[t]},some:function(e){return e[t]}})}(e,t.payload),r=function(e){switch(e.direction){case I.None:return Object(u.a)(Object(u.a)({},e),{},{direction:I.Forward});case I.Forward:return Object(u.a)(Object(u.a)({},e),{},{direction:I.Reverse});case I.Reverse:return Object(u.a)(Object(u.a)({},e),{},{direction:I.None})}}(n);return Object(u.a)(Object(u.a)({},e),{},{graph:Object(u.a)(Object(u.a)({},e.graph),{},{edges:Object(u.a)(Object(u.a)({},e.graph.edges),{},{byId:Object(u.a)(Object(u.a)({},e.graph.edges.byId),{},Object(l.a)({},n.id,r)),wip:e.graph.edges.wip.map((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(l.a)({},n.id,r))}))})})})}(e,t);case D.CommitCurrentGraphState:return function(e){return Object(u.a)(Object(u.a)({},e),{},{undoRedo:e.undoRedo.commit(e.graph)})}(e);case D.Undo:return function(e){return e.undoRedo.undo().match({none:function(){return e},some:function(t){var n=Object(s.a)(t,2),r=n[0],c=n[1];return Object(u.a)(Object(u.a)({},e),{},{ui:Object(u.a)(Object(u.a)({},e.ui),{},{selection:oe(e,r)}),graph:r,undoRedo:c})}})}(e);case D.Redo:return function(e){return e.undoRedo.redo().match({none:function(){return e},some:function(t){var n=Object(s.a)(t,2),r=n[0],c=n[1];return Object(u.a)(Object(u.a)({},e),{},{graph:r,undoRedo:c})}})}(e);case D.OpenGraphOverlay:return function(e,t){return Object(u.a)(Object(u.a)({},e),{},{overlay:C.Graph(t.payload)})}(e,t);case D.OpenErrorsOverlay:return function(e,t){return Object(u.a)(Object(u.a)({},e),{},{overlay:C.Errors(t.payload)})}(e,t);case D.DismissOverlay:return function(e){return Object(u.a)(Object(u.a)({},e),{},{overlay:C.None()})}(e);default:return e}}function oe(e,t){return Z(e).match({none:function(){return Z(e)},vertices:function(e){var n=Object.values(t.vertices.byId).map((function(e){return e.id}));return k.Vertices(e.filter((function(e){return n.includes(e)})))}})}var ie=function(e){var t=e.c,n=e.pq,r=e.direction;if(r===I.None)return null;var c=r===I.Forward,a=n.normalize().scale(c?-30:30),o=a.rotate(Math.PI/10),i=a.rotate(-Math.PI/10),u=t.plus(o),s=t.plus(i);return Object(T.jsx)("path",{d:"M ".concat(t.x," ").concat(t.y," L ").concat(u.x," ").concat(u.y," L ").concat(s.x," ").concat(s.y),className:"edge-arrow",stroke:"none"})},ue=function(e){var t=a.a.useContext(P),n=t.state,r=t.dispatch,c=e.startVertexId,o=e.endVertexId,i=e.controlPtPos,u=e.id,s=e.direction,d=q(n,c),h=q(n,o),l=h.minus(d),f=l.scale(.5),p=i.minus(d),b=d.plus(p.scale(2)).minus(f),j=function(e,t){return e.graph.edges.hovered.match({none:function(){return!1},some:function(e){return e===t}})}(n,u);return Object(T.jsxs)("g",{children:[Object(T.jsx)("path",{className:"edge-path",d:"M ".concat(d.x," ").concat(d.y," Q ").concat(b.x," ").concat(b.y,", ").concat(h.x," ").concat(h.y),strokeWidth:"2",fill:"none"}),Object(T.jsxs)("g",{className:"edge-control",onMouseEnter:function(){return r((e=u,{type:D.MouseEnterEdgeControlPt,payload:e}));var e},onMouseLeave:function(){return r({type:D.MouseLeaveEdgeControlPt})},onMouseDown:function(){return r((e=u,{type:D.MouseDownEdgeControlPt,payload:e}));var e},onMouseUp:function(){if(!te(n))return r((e=u,{type:D.ToggleEdgeDirection,payload:e}));var e},children:[Object(T.jsx)("circle",{cx:i.x,cy:i.y,r:"12",fill:"transparent"}),Object(T.jsx)("circle",{cx:i.x,cy:i.y,r:j?14:4,className:"edge-control-point"}),";",Object(T.jsx)(ie,{c:i,pq:l,direction:s})]})]})},se=function(){var e=a.a.useContext(P).state;return function(e){return e.ui.dragSubject}(e).match({boxSelection:function(t){var n=new g(t,X(e));return Object(T.jsx)("rect",{x:n.x,y:n.y,width:n.width,height:n.height,className:"box-selection"})},none:function(){return null},vertices:function(){return null},edgeControlPt:function(){return null},newVertex:function(){return null}})},de=function(){var e=a.a.useContext(P),t=e.state,n=e.dispatch,r=function(e){var t={name:"Add Vertex [a]",clickAction:K()};return Z(e).match({none:function(){return[t]},vertices:function(n){switch(n.length){case 1:return[t,{name:"Remove Vertex [d]",clickAction:L(n)}];case 2:var r=[t,{name:"Remove Vertices [d]",clickAction:L(n)}],c=Object(s.a)(n,2),a=c[0],o=c[1];return H(e,a,o).match({some:function(e){return[].concat(r,[{name:"Remove Edge [e]",clickAction:G(e.id)}])},none:function(){return[].concat(r,[{name:"Add Edge [e]",clickAction:U(a,o)}])}});default:return[t,{name:"Remove Vertices [d]",clickAction:L(n)}]}}})}(t);return Object(T.jsxs)("div",{className:"actions",children:[Object(T.jsx)("div",{className:"actions-lhs",children:r.map((function(e,t){return Object(T.jsx)("button",{onClick:function(){return n(e.clickAction)},children:e.name},t)}))}),Object(T.jsxs)("div",{className:"actions-rhs",children:[Object(T.jsx)("a",{href:"https://github.com/wjlewis/giraffe",target:"_blank",rel:"noreferrer",children:"Source"}),Object(T.jsx)("a",{href:"https://github.com/wjlewis/giraffe/blob/master/README.md",target:"_blank",rel:"noreferrer",children:"Instructions"}),Object(T.jsx)("button",{onClick:function(){re(t).match({err:function(e){return n(function(e){return{type:D.OpenErrorsOverlay,payload:e}}(e))},ok:function(e){return n(function(e){return{type:D.OpenGraphOverlay,payload:e}}(e))}})},children:"Export"})]})]})},he=function(){var e=a.a.useContext(P),t=e.state,n=e.dispatch;function r(){return n({type:D.MouseDownNewVertex})}return function(e){return e.ui.dragSubject.isNewVertex()?j.Some(e.ui.mousePos):j.None()}(t).match({none:function(){return null},some:function(e){return Object(T.jsx)("circle",{cx:e.x,cy:e.y,r:z,onMouseDown:r,strokeWidth:"2",className:"new-vertex"})}})},le=function(){var e=a.a.useContext(P),t=e.state,n=e.dispatch,r=a.a.useRef(null),c=a.a.useState(!1),o=Object(s.a)(c,2),i=o[0],u=o[1],d=function(e){return e.overlay}(t);if(d.isNone())return null;function h(e){e.currentTarget===e.target&&n({type:D.DismissOverlay})}function l(){if(r.current){var e=r.current;e.focus(),e.select(),document.execCommand("copy"),u(!0),setTimeout((function(){u(!1)}),1e3)}}return Object(T.jsx)("div",{id:"overlay",onClick:h,children:d.match({none:function(){throw new Error("unreachable")},graph:function(e){return Object(T.jsxs)("article",{className:"graph-report",children:[Object(T.jsx)("p",{children:"Copy and paste the output below into a Mathematica document:"}),Object(T.jsxs)("div",{className:"graph-text-container",children:[Object(T.jsx)("input",{ref:r,className:"graph-text",value:e,onChange:y}),Object(T.jsx)("button",{onClick:l,disabled:i,children:i?"Copied!":"Copy"})]}),Object(T.jsx)("button",{onClick:h,children:"Dismiss"})]})},errors:function(e){return Object(T.jsxs)("article",{className:"error-report",children:[Object(T.jsx)("p",{children:"We were unable to export your graph for the following reasons:"}),Object(T.jsx)("div",{className:"errors",children:e.map((function(e,t){return Object(T.jsx)("p",{className:"error-text",children:e},t)}))}),Object(T.jsx)("button",{onClick:h,children:"Dismiss"})]})}})})},fe=function(){var e=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),c=2;c<n;c++)r[c-2]=arguments[c];var o=a.a.useReducer(e,t),i=Object(s.a)(o,2),u=i[0],h=i[1];return(r=Object(d.a)(r)).reverse(),r.forEach((function(e){h=e(u,h)})),[u,h]}(ae,A,ce(),(function(e,t){return function(n){switch(n.type){case D.MouseDownNewVertex:case D.AddEdge:case D.RemoveVertices:case D.RemoveEdge:case D.ToggleEdgeDirection:return t(n),t(B());case D.MouseUp:return te(e)?(t(n),t(B())):t(n);default:return t(n)}}})),t=Object(s.a)(e,2),n=t[0],r=t[1],c=a.a.useRef(null),o=function(e){var t=a.a.useState({width:0,height:0}),n=Object(s.a)(t,2),r=n[0],c=n[1],o=a.a.useCallback((function(){if(e.current){var t=e.current.getBoundingClientRect(),n=t.width,r=t.height;return c({width:n,height:r})}}),[e]);return a.a.useLayoutEffect((function(){o()}),[o]),a.a.useEffect((function(){return window.addEventListener("resize",o),function(){return window.removeEventListener("resize",o)}}),[o]),r}(c),i=o.width,h=o.height;!function(e,t){var n=a.a.useState({left:0,top:0}),r=Object(s.a)(n,2),c=r[0],o=r[1];a.a.useEffect((function(){if(e.current){var t=e.current.getBoundingClientRect(),n=t.left,r=t.top;o({left:n,top:r})}}),[e,o]),a.a.useEffect((function(){var e=c.left,n=c.top;function r(r){t(new b(r.clientX-e,r.clientY-n))}return document.addEventListener("mousemove",r),function(){return document.removeEventListener("mousemove",r)}}),[c,t])}(c,(function(e){return r(function(e){return{type:D.MouseMove,payload:e}}(new b(e.x-i/2,e.y-h/2)))})),function(e){var t=e.onKeyDown,n=void 0===t?y:t,r=e.onKeyUp,c=void 0===r?y:r;a.a.useEffect((function(){function e(e){if(e.currentTarget===e.target){var t=e.key,r=e.ctrlKey,c=e.metaKey;n({key:t,ctrlKey:r,metaKey:c})}}function t(){c()}return document.body.addEventListener("keydown",e),document.body.addEventListener("keyup",t),function(){document.body.removeEventListener("keydown",e),document.body.removeEventListener("keyup",t)}}),[n,c])}({onKeyDown:function(e){return r(function(e){return{type:D.KeyDown,payload:e}}(e))},onKeyUp:function(){return r({type:D.KeyUp})}});var l="translate(".concat(i/2," ").concat(h/2,")"),f=J(n),p=_(n);return Object(T.jsxs)(P.Provider,{value:{state:n,dispatch:r},children:[Object(T.jsx)("main",{children:Object(T.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",ref:c,onMouseDown:function(e){if(e.currentTarget===e.target)return r({type:D.MouseDownCanvas})},onMouseUp:function(){return r({type:D.MouseUp})},children:Object(T.jsxs)("g",{transform:l,children:[f.map((function(e){return Object(T.jsx)(ue,Object(u.a)({},e),e.id)})),p.map((function(e){return Object(T.jsx)(F,Object(u.a)({},e),e.id)})),Object(T.jsx)(se,{}),Object(T.jsx)(he,{})]})})}),Object(T.jsx)("footer",{children:Object(T.jsx)("nav",{children:Object(T.jsx)(de,{})})}),Object(T.jsx)(le,{})]})};i.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(fe,{})}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.fee97c39.chunk.js.map